<!DOCTYPE html>
<html>
    <head>
		<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
		<title>Assignment1 - Etienne Cuvillon & Loric Brevet</title>
    </head>

    <body>
		<div>
			<h1>Assignment1: Multiple Inheritance in Javascript</h1>
			<p>Etienne Cuvillon & Loric Brevet</p>
			<p>Grade A-B</p>
		</div>

        <script>
        //Prototype-Based Multiple Inheritance 
        console.log("1. Prototype-Based Multiple Inheritance:");
		
        var myObject = {
            create: function(prototypeList) {
                var obj = Object.create(this);
                obj.prototypeList = prototypeList;
				obj.infiniteLoop = false; // To prevent circular inheritance
                return obj;
            },
            call: function(funcName, parameters) {
				// Check for infinite loop
				if (this.infiniteLoop) { // We already went through this object
					return "Warning: infinite loop";
				}
                // If function exists in instance
                if (typeof this[funcName] == 'function') {
                    return this[funcName](parameters);
                }
                // Search for function in parents
                if(this.prototypeList == null) { // No parent
					return undefined;
                }
                // List of one or more parents
				var func, i=0;
				this.infiniteLoop = true; // Indicate we already have been in this object
                while((func == null) && (i < this.prototypeList.length)) {
                    func = this.prototypeList[i++].call(funcName, parameters);
                }
				this.infiniteLoop = false; // Reset the indicator of infinite loop
                return func;
            }
        }
		
        var obj0 = myObject.create(null);
        obj0.func = function(arg) { return "func0: " + arg; };
        var obj1 = myObject.create([obj0]);
        var obj2 = myObject.create([]);
        obj2.func = function(arg) { return "func2: " + arg; };
        var obj3 = myObject.create([obj1, obj2]);
        var result = obj3.call("func", ["hello"]);
		console.log(result);

		//Class-Based Multiple Inheritance
        console.log("2. Class-Based Multiple Inheritance:");
		
		// Circular Inheritance
		console.log("3. Circular Inheritance Prevention:");
		//Prototype
		console.log("3.1 For prototypes");
		var obj1 = myObject.create(null);
		var obj2 = myObject.create([obj1]);
		obj1.prototypeList = [obj2]; // We set the circular inheritance
		var result = obj1.call("func", ["hello"]); // We should obtain a warning for infinite loop
		console.log(result);
		
		//Class
		console.log("3.2 For classes");
        </script>        
    </body>
</html>